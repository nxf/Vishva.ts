<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">

        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
        <meta name="Vishva" content="">
        <meta name="Satguru Srivatavaa" content="">
        <link rel="icon" href="../../favicon.ico">

        <title>Vishva</title>


        <script src="lib/jquery-darkness-flat/jquery-2.2.0.min.js"></script>
        <script src="lib/jquery-darkness-flat/jquery-ui.min.js"></script>
        <link href="lib/jquery-darkness-flat/jquery-ui.min.css" rel="stylesheet">

        <script src="lib/cannon.js"></script>
        <script src="lib/babylon.2.6-12-16-2016.js"></script>
        <script src="lib/babylon.waterMaterial.min.js"></script>
        <script src="lib/pep.0.4.1.min.js"></script>
        <script src="lib/colorpicker.min.js"></script>

        <link href="lib/colorpicker.themes.css" rel="stylesheet">
        <script type="text/javascript" src="lib/colorpicker.js"></script>

        <style>
            html, body {
                width: 100%;
                height: 100%;
                padding: 0;
                margin: 0;
                overflow: hidden;
                font: 80% "Trebuchet MS", sans-serif;
                background: #000000;
                color: #ffffff;
            }
            

            /* #sNaDiag */
            /* required as jquery dialog size does not re-adjust to content after it has been dragged */
            /* unfortunately messes up the dialog box for add items */
            /*
            .ui-dialog {
                          height:auto !important;
                          width: auto !important;
                          
             }
            */


            /* reduce the overlay for modal dialogs */
            .ui-widget-overlay {
                opacity: 0.2;
            }

            .navMenu {
                position: absolute;
            }

            .ui-menu {
                width: 200px;
            }

            table {
                border-radius: 10px;
                background: red;
            }

            table, th, td {
                border: 1px solid black;
                padding: 5px;
                padding-left: 15px;
                padding-right: 15px;
                border-collapse: collapse;
            }

            #vCanvas {
                min-height: 700px;
                min-width: 500px;
                position: absolute;
                top: 0;
                right: 0;
                width: 100%;
                height: 100%;
            }

            #gui-items {
                visibility: hidden;
                position: absolute;
                top: 0;
                right: 0;
                width: 100%;
                height: 100%;
            }

        </style>

    </head>
    <body>

        <canvas id="vCanvas" oncontextmenu="return false;" tabindex="1"></canvas>

        <div id="gui-items">

            <div id="loadingMsg"
                 style="text-align: center; display: inline-block; position: fixed; top: 0; bottom: 0; left: 0; right: 0; width: 200px; height: 100px; margin: auto;">
                <h1>loading</h1>
                <h1>please wait</h1>
                <br>
                <h2 id="loadingStatus">...</h2>
            </div>

            <div style="padding: 4px; position: absolute; top: 0px; left: 0px;  ">
                <button id="showNavMenu">&#9776;</button>
            </div>

            <div id="navMenubar" style="padding: 4px; display: inline-block; position: absolute;">
                <button id="downWorld">Save</button>
                <button id="navAdd">Add</button>
                <button id="navEnv">Environment</button>
                <button id="navEdit">Edit</button>
                <button id="navSettings">Settings</button>
                <button id="helpLink">Help</button>
                <button id="debugLink">Debug</button>
            </div>

            <ul id="AddMenu" style="position: absolute; width: auto; ">
            </ul>

            <div id="editDiv" title="Edit">
                <ul id="editMenu">
                    <li id="showProps">Mesh Properties</li>
                    <li>-</li>
                    <li id="swAv">Use as Avatar</li>
                    <li id="swGnd">Use as Ground</li>
                    <li>-</li>
                    <li id="parentMesh">Make Parent</li>
                    <li id="removeParent">Remove Parent</li>
                    <li id="removeChildren">Remove Children</li>
                    <li>-</li>
                    <li id="downMesh">Download Mesh</li>
                    <li id="instMesh">Create Instance</li>
                    <li id="cloneMesh">Clone Mesh</li>
                    <li id="delMesh">Delete Mesh</li>
                    <li id="visMesh">Toggle Visibility</li>
                    <li id="showInvis">Show all invisibles</li>
                    <li id="hideInvis">Hide all invisibles</li>
                    <li id="togCol">Toggle Collision</li>
                    <li id="togEna">Toggle Enable</li>
                    <li id="showDisa">Show all Disabled</li>
                    <li id="hideDisa">Hide all Disabled</li>
                    <li>-</li>
                    <li id="addWater">Add water</li>
                    <li>-</li>
                    <li id="local">Switch to Global Axis</li>
                    <li id="undo">Undo</li>
                    <li id="redo">Redo</li>
                    <li id="snapTrans">Snap Translate On</li>
                    <li id="snapRot">Snap Rotate On</li>
                    <li id="snapSet">Snap Setting</li>
                    <li id="snapper">Snapper On</li>
                    <li>-</li>
                    <li id="sNa">Sensors & Actuators</li>
                    <!--
                    <li id="meshAnims">Animations</li>
                    <li id="meshMat">Materials</li>
                    <li id="meshTrans">Transform</li>
                    -->
                </ul>
            </div>

            <div id="envDiv" title="Environment">
                <table style="width: 100%; text-align: center;">
                    <tr>
                        <td>sun (west-east)</td>
                        <td><div id="sunPos"></div></td>
                    </tr>
                    <tr>
                        <td>light</td>
                        <td><div id="light"></div></td>
                    </tr>
                    <tr>
                        <td>shade</td>
                        <td><div id="shade"></div></td>
                    </tr>
                    <tr>
                        <td>fog</td>
                        <td><div id="fog"></div></td>
                    </tr>
                    <tr>
                        <td>fov</td>
                        <td><div id="fov"></div></td>
                    </tr>
                    <tr>
                        <td>sky</td>
                        <td><Button id="skyButton">Select Sky</button></td>
                    </tr>
                    <tr>
                        <td>terrain</td>
                        <td><Button id="trnButton">Select Terrain</button></td>
                    </tr>
                    <tr>
                        <td>terrain color</td>
                        <td><div ondragstart="return false;" id="color-picker" class="cp-small"></div></td>
                    </tr>
                </table>
            </div>

            <div id="settingDiag" title="Settings" data-keyboard="false">
                <table style="width: 100%; text-align: center;">
                    <tr>
                        <td>camera collision</td>
                        <td><input id="camCol" type="checkbox"/></td>
                    </tr>
                    <tr>
                        <td>show edit menu on mesh selection</td>
                        <td><input id="autoEditMenu" type="checkbox"/></td>
                    </tr>
                </table>

            </div>

            <div id="sNaDiag">
                <div id="sNaDetails">
                    <ul>
                        <li><a href="#sensors">Sensors</a></li>
                        <li><a href="#actuators">Actuators</a></li>
                    </ul>
                    <div id="sensors">
                        <button id="addSens">add</button>
                        <select id="sensSel" class="ui-widget-content ui-corner-all"></select>
                        <p>
                        <table id="sensTbl" style="text-align: center;">
                            <tr>
                                <td>name</td>
                                <td>signal</td>
                                <td>edit</td>
                                <td>del</td>
                            </tr>
                        </table>
                    </div>
                    <div id="actuators">
                        <button id="addAct">add</button>
                        <select id="actSel" class="ui-widget-content ui-corner-all"></select>
                        <p>
                        <table id="actTbl" style="text-align: center;">
                            <tr>
                                <td>name</td>
                                <td>signal</td>
                                <td>edit</td>
                                <td>del</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>

            <div id="editSensDiag">
                Sensor:<label id="editSensDiag.sensName">sensor name</label>
                <p>Sensor Properties
                <div id="editSensDiag.parms"></div>
            </div>

            <div id="editActDiag">
                Actuator:<label id="editActDiag.actName">actuator name</label>
                <p>Actuator Properties
                <div id="editActDiag.parms"></div>
            </div>

            <div id="propsDiag" title="mesh properties">

                <!--
               
                -->
                <div id="propsTabs">

                    <ul>
                        <li><a href="#gen">General</a></li>
                        <li><a href="#meshTransDiag">Transforms</a></li>
                        <li><a href="#Physics">Physics</a></li>
                        <li><a href="#Material">Material</a></li>
                        <li><a href="#Lights">Lights</a></li>
                        <li><a href="#meshAnimDiag">Animations</a></li>
                    </ul>

                    <div id="gen" >
                        <table>
                            <tr>
                                <td>name</td>
                                <td><input type="text" id="genName"></td>
                            </tr>
                            <tr>
                                <td>disable</td>
                                <td><input type="checkbox" id="genDisable"></td>
                            </tr>
                            <tr>
                                <td>collision</td>
                                <td><input type="checkbox" id="genColl"></td>
                            </tr>
                            <tr>
                                <td>visible</td>
                                <td><input type="checkbox" id="genVisi"></td>
                            </tr>
                            <tr>
                                <td>local axis</td>
                                <td><input type="checkbox" id="genlocalAxis"></td>
                            </tr>
                        </table>
                        <br>
                        <button id ="genApply">apply</button>
                        <button id ="genRestore">restore</button>
                    </div>

                    <div id="meshTransDiag" title="Transforms">
                        <table>
                            <tr>
                                <td></td>
                                <td>x</td>
                                <td>y</td>
                                <td>z</td>
                            </tr>
                            <tr>
                                <td>location</td>
                                <td id="loc.x"></td>
                                <td id="loc.y"></td>
                                <td id="loc.z"></td>
                            </tr>
                            <tr>
                                <td>rotation</td>
                                <td id="rot.x"></td>
                                <td id="rot.y"></td>
                                <td id="rot.z"></td>
                            </tr>
                            <tr>
                                <td>scale</td>
                                <td id="scl.x"></td>
                                <td id="scl.y"></td>
                                <td id="scl.z"></td>
                            </tr>
                        </table>
                        <br>
                        <button id="transRefresh">refresh</button>
                    </div>

                    <div id="Physics" >
                        <table>
                            <tr>
                                <td>enabled</td>
                                <td><input type="checkbox" id="phyEna" ></td>
                            </tr>
                            <tr>
                                <td>type</td>
                                <td><select id="phyType">
                                        <option value="2">box</option>
                                        <option value="1">sphere</option>
                                        <option value="3">plane</option>
                                        <option value="7">cylinder</option>
                                        <option value="4">mesh</option>
                                        <!--
                                        <option value="8">particle</option>
                                        <option value="9">height map</option>
                                        -->
                                    </select></td>
                            </tr>
                            <tr>
                                <td>mass</td>
                                <td><input type="text" id="phyMass" size="3" value="1"></td>
                            </tr>
                            <tr>
                                <td>restitution : <output for="phyRes" id="phyResVal"></output></td>
                                <td>
                                    <input type="range" id="phyRes" min="0.0" max="1.0" step="0.1" value="0.0">

                                </td>
                            </tr>
                            <tr>
                                <td>friction : <output for="phyFric" id="phyFricVal"></output> </td>
                                <td>
                                    <input type="range" id="phyFric" min="0.0" max="1.0" step="0.1" value="0.0">

                                </td>
                            </tr>
                        </table>
                        <br>
                        <button id ="phyApply">apply</button>
                        <button id ="phyRestore">restore</button>
                    </div>

                    <div id="Material" >
                        <select id="matSelect">
                            <option value="wood">Wood</option>
                            <option value="marble">Marble</option>
                            <option value="fire">Fire</option>
                        </select>
                    </div>

                    <div id="Lights" >
                        <table>
                            <tr>
                                <td>attach</td>
                                <td><input type="checkbox" id="lightAtt" ></td>
                            </tr>
                            <tr>
                                <td>type</td>
                                <td><select id="lightType" oninput="showOpt();">
                                        <option value="Spot">spot</option>
                                        <option value="Dir">directional</option>
                                        <option value="Point">point</option>
                                        <option value="Hemi">hemispheric</option>
                                    </select></td>
                            </tr>
                            <tr>
                                <td>diffuse</td>
                                <td><input type="color" id="lightDiff" value="#ffffff"></td>
                            </tr>
                            <tr>
                                <td>specular </td>
                                <td>
                                    <input type="color" id="lightSpec" value="#ffffff">
                                </td>
                            </tr>
                            <tr>
                                <td>intensity </td>
                                <td>
                                    <input type="range" id="lightInten" min="0.0" max="1.0" step="0.1" value="0.0">
                                </td>
                            </tr>
                            <tr>
                                <td>range</td>
                                <td>
                                    <input type="text" id="lightRange" size="3" value="1">
                                </td>
                            </tr>
                            <tr>
                                <td>radius</td>
                                <td>
                                    <input type="text" id="lightRadius" size="3" value="1">
                                </td>
                            </tr>
                            <tr class="opt Spot">
                                <td>angle</td>
                                <td>
                                    <input type="range" id="lightAngle" min="0.0" max="180.0" step="1" value="45.0">
                                </td>
                            </tr>
                            <tr class="opt Spot">
                                <td>exponent</td>
                                <td>
                                    <input type="text" id="lightExp" size="3" value="1">
                                </td>
                            </tr>
                            <tr class="opt Hemi">
                                <td>ground color</td>
                                <td>
                                    <input type="color" id="lightGndClr" value="#ffffff">
                                </td>
                            </tr>
                            <tr class="opt Hemi">
                                <td>direction (x,y,z)</td>
                                <td>
                                    <input type="text" id="lightDirX"  size="1" value="1">
                                    <input type="text" id="lightDirY" size="1" value="1">
                                    <input type="text" id="lightDirZ" size="1" value="1">
                                </td>
                            </tr>
                        </table>
                        <br>
                        <button id ="lightApply">apply</button>
                        <button id ="lightRestore">restore</button>
                        <script>
                            function showOpt() {
                                var cls = "." + $("#lightType").val();
                                $(".opt").hide();
                                $(cls).show();
                            }
                            showOpt();
                        </script>
                    </div>

                    <div id="meshAnimDiag" title="Animations">
                        <table>
                            <tr>
                                <td>skeleton name</td>
                                <td>ranges</td>
                                <td>from frame</td>
                                <td>to frame</td>
                            </tr>
                            <tr>
                                <td id="skelName"></td>
                                <td><select id="animList"></select></td>
                                <td id="animFrom"></td>
                                <td id="animTo"></td>
                            </tr>
                        </table>
                        <br>
                        <table>
                            <tr>
                                <td>rate</td>
                                <td><input id="animRate" type="text" value="1" size="2"></td>
                            </tr>
                            <tr>
                                <td>loop</td>
                                <td><input type="checkbox" id="animLoop"></td>
                            </tr>
                            <tr>
                                <td><button id="playAnim">play</button></td>
                                <td><button id="stopAnim">stop</button></td>
                            </tr>
                        </table>
                    </div>

                </div>
            </div>





            <div id="matDiag">
                <select id="matSelect">
                    <option value="wood">Wood</option>
                    <option value="marble">Marble</option>
                    <option value="fire">Fire</option>
                </select>
            </div>


            <div id="saveDiv">
                <br>Your file is ready for download.
                <p>
                    <a id="downloadLink" href="www" download>Right click here and select "Save link as..." to save this file on your computer</a> <br> <br>
            </div>

            <div id="loadDiv">
                <form id="fileLoadForm">
                    Select File <input id="loadFileInput" type="file"/>
                </form>
                <p>
                    <button id="loadFileOk">Load File</button>
            </div>

            <div id="alertDiv" style="text-align:center;"></div>

            <div id="helpDiv" title="Help">
                <h4>Avatar Movement Keys</h4>
                <ul>
                    <li>Turn left, right - press "A,D" or "left,right arrow" key or press and drag left mouse key
                    <li>Strafe left, right - press "Q,E" key
                    <li>Go forward, backward - press "W,S" or "up,down arrow" key
                    <li>Run - press "shift" key while going forward, backward
                    <li>Jump - press and release "space" key
                </ul>
                <h4>Item Edit Keys</h4>
                <ul>
                    <li>To select item - right click the item,
                    <li>To unselect item - press"Esc" key
                    <li>To move,rotate or scale selected item -press "1,2,or 3" key
                    <li>To focus (center the camera)on selected item - press "F" key
                    <li>To zoom in or out of focused item - scroll mouse wheel forward or backward
                    <li>To pan around focused item - press "Ctrl" key and then press and drag mouse right key
                </ul>
            </div>

        </div>



        <script type="text/javascript" src="lib/EditControl.js"></script>
        <script type="text/javascript" src="config.js"></script>
        <script type="text/javascript" src="worlds.js"></script>
        <script type="text/javascript" src="assets.js"></script>
        <!--
        <script type="text/javascript" src="js/VishvaGUI.js"></script>
        <script type="text/javascript" src="js/Vishva.js"></script>
        <script type="text/javascript" src="js/HREFsearch.js"></script>
        -->
        <script type="text/javascript" src="js/Vishva-merged.js"></script>
        <script type="text/javascript">
                            $(function () {

                                //change all buttons to jquery button
                                $("button").button();
                                $("button").click(function (e) {
                                    $(this).blur();
                                });

                                var HREFsearch = org.ssatguru.babylonjs.util.HREFsearch;
                                var search = new HREFsearch();

                                var world, worldFolder, sceneFolder, sceneFile, editEnabled;

                                world = search.getParm("world");
                                if (world != "empty") {
                                    if (!world) {
                                        if (config) {
                                            world = config.world;
                                        }
                                    }

                                    if (worlds && world) {
                                        var worldData = worlds[world];
                                        if (worldData) {
                                            worldFolder = worldData.worldFolder;
                                            sceneFolder = worldData.sceneFolder;
                                            sceneFile = worldData.sceneFile;
                                            editEnabled = worldData.editEnabled;
                                        }
                                    }

                                    var scenePath = "vishva/worlds/" + worldFolder + "/"
                                            + sceneFolder + "/";
                                }
                                if (editEnabled == null)
                                    editEnabled = true;
                                var Vishva = org.ssatguru.babylonjs.vishva.Vishva;
                                var vishva = new Vishva(scenePath, sceneFile, "vCanvas",
                                        editEnabled, assets);
                            });
        </script>
    </body>

</html>