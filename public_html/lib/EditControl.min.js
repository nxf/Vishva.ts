var org;!function(t){!function(t){!function(t){!function(t){var i,s=BABYLON.Axis,e=BABYLON.Color3,n=BABYLON.Matrix,h=BABYLON.Mesh,a=BABYLON.MeshBuilder,o=BABYLON.Path2,r=BABYLON.Quaternion,l=BABYLON.Space,c=BABYLON.StandardMaterial,p=BABYLON.Vector3;!function(t){t[t.TRANS=0]="TRANS",t[t.ROT=1]="ROT",t[t.SCALE=2]="SCALE"}(i||(i={}));var d=function(){function t(t,i,s,e,a){var o=this;this.local=!0,this.snapT=!1,this.snapR=!1,this.transSnap=1,this.rotSnap=Math.PI/18,this.axesLen=.4,this.axesScale=1,this.pickWidth=.02,this.visibility=.75,this.lhsRhs=!1,this.ecMatrix=new n,this.ecTOcamera=new p(0,0,0),this.distFromCamera=2,this.cameraTOec=new p(0,0,0),this.cameraNormal=new p(0,0,0),this.prevState="",this.hidden=!1,this.actionListener=null,this.actionStartListener=null,this.actionEndListener=null,this.pDown=!1,this.pointerIsOver=!1,this.editing=!1,this.snapRX=0,this.snapRY=0,this.snapRZ=0,this.rotate2=!1,this.transBy=new p(0,0,0),this.snapTV=new p(0,0,0),this.snapS=!1,this.snapSX=0,this.snapSY=0,this.snapSZ=0,this.snapSA=0,this.snapSV=new p(0,0,0),this.scaleSnap=.25,this.scale=new p(0,0,0),this.eulerian=!1,this.snapRA=0,this.transEnabled=!1,this.rotEnabled=!1,this.scaleEnabled=!1,this.guideSize=180,this.localX=new p(0,0,0),this.localY=new p(0,0,0),this.localZ=new p(0,0,0),this.tSnap=new p(this.transSnap,this.transSnap,this.transSnap),this.tv1=new p(0,0,0),this.tv2=new p(0,0,0),this.tv3=new p(0,0,0),this.tm=new n,this.mesh=t,this.mainCamera=i,this.canvas=s,this.axesScale=e,this.eulerian=null!==a&&a,this.checkQuaternion(),this.scene=t.getScene(),this.actHist=new u(t,10),t.computeWorldMatrix(!0),this.boundingDimesion=this.getBoundingDimension(t),this.setLocalAxes(t),this.ecRoot=new h("EditControl",this.scene),this.ecRoot.rotationQuaternion=r.Identity(),this.ecRoot.visibility=0,this.ecRoot.isPickable=!1,this.createMaterials(this.scene),this.createCommonAxes().parent=this.ecRoot,this.createPickPlanes().parent=this.ecRoot,this.pointerdown=function(t){return o.onPointerDown(t)},this.pointerup=function(t){return o.onPointerUp(t)},this.pointermove=function(t){return o.onPointerMove(t)},s.addEventListener("pointerdown",this.pointerdown,!1),s.addEventListener("pointerup",this.pointerup,!1),s.addEventListener("pointermove",this.pointermove,!1),this.renderer=function(){return o.renderLoopProcess()},this.scene.registerBeforeRender(this.renderer)}return t.prototype.checkQuaternion=function(){if(!this.eulerian&&(null==this.mesh.rotationQuaternion||void 0==this.mesh.rotationQuaternion))throw"Error: Eulerian is set to false but the mesh's rotationQuaternion is not set."},t.prototype.renderLoopProcess=function(){this.ecRoot.position=this.mesh.getAbsolutePivotPoint(),this.local?(this.ecRoot.getWorldMatrix().invertToRef(this.ecMatrix),p.TransformCoordinatesToRef(this.mainCamera.position,this.ecMatrix,this.ecTOcamera),this.pALL.lookAt(this.ecTOcamera,0,0,0,l.LOCAL)):(this.mainCamera.position.subtractToRef(this.ecRoot.position,this.ecTOcamera),this.pALL.lookAt(this.mainCamera.position,0,0,0,l.WORLD)),this.setAxesScale(),this._setAxesRotation(),this.rotEnabled?this.rotRotGuides():this.transEnabled?this.rotPlanarGuides(this.tXZ,this.tZY,this.tYX):this.scaleEnabled&&this.rotPlanarGuides(this.sXZ,this.sZY,this.sYX)},t.prototype.setAxesScale=function(){this.ecRoot.position.subtractToRef(this.mainCamera.position,this.cameraTOec),p.FromFloatArrayToRef(this.mainCamera.getWorldMatrix().asArray(),8,this.cameraNormal);var t=p.Dot(this.cameraTOec,this.cameraNormal)/this.cameraNormal.length(),i=Math.abs(t/this.distFromCamera);p.FromFloatsToRef(i,i,i,this.ecRoot.scaling)},t.prototype._setAxesRotation=function(){if(this.local)if(null==this.mesh.parent)if(this.eulerian){var t=this.mesh.rotation;r.RotationYawPitchRollToRef(t.y,t.x,t.z,this.ecRoot.rotationQuaternion)}else this.ecRoot.rotationQuaternion.copyFrom(this.mesh.rotationQuaternion);else this.mesh.getWorldMatrix().getRotationMatrixToRef(this.tm),r.FromRotationMatrixToRef(this.tm,this.ecRoot.rotationQuaternion)},t.prototype.rotRotGuides=function(){var t=Math.atan(this.ecTOcamera.y/this.ecTOcamera.z);this.ecTOcamera.z>=0?this.rX.rotation.x=-t:this.rX.rotation.x=-t-Math.PI;var i=Math.atan(this.ecTOcamera.x/this.ecTOcamera.z);this.ecTOcamera.z>=0?this.rY.rotation.y=i:this.rY.rotation.y=i+Math.PI;var s=Math.atan(this.ecTOcamera.x/this.ecTOcamera.y);this.ecTOcamera.y>=0?this.rZ.rotation.z=-s:this.rZ.rotation.z=-s-Math.PI},t.prototype.rotPlanarGuides=function(t,i,s){var e=this.ecTOcamera;t.rotation.x=0,t.rotation.y=0,t.rotation.z=0,i.rotation.x=0,i.rotation.y=0,i.rotation.z=0,s.rotation.x=0,s.rotation.y=0,s.rotation.z=0,e.x<=0&&e.y>=0&&e.z>=0?(t.rotation.z=3.14,s.rotation.y=3.14):e.x<=0&&e.y>=0&&e.z<=0?(t.rotation.y=3.14,i.rotation.y=3.14,s.rotation.y=3.14):e.x>=0&&e.y>=0&&e.z<=0?(t.rotation.x=3.14,i.rotation.y=3.14):e.x>=0&&e.y<=0&&e.z>=0?(i.rotation.z=3.14,s.rotation.x=3.14):e.x<=0&&e.y<=0&&e.z>=0?(t.rotation.z=3.14,i.rotation.z=3.14,s.rotation.z=3.14):e.x<=0&&e.y<=0&&e.z<=0?(t.rotation.y=3.14,i.rotation.x=3.14,s.rotation.z=3.14):e.x>=0&&e.y<=0&&e.z<=0&&(t.rotation.x=3.14,i.rotation.x=3.14,s.rotation.x=3.14)},t.prototype.switchTo=function(t,i){t.computeWorldMatrix(!0),this.mesh=t,null!=i&&(this.eulerian=i),this.checkQuaternion(),this.setLocalAxes(t),this.actHist=new u(t,10)},t.prototype.setUndoCount=function(t){this.actHist.setCapacity(t)},t.prototype.undo=function(){var t=this.actHist.undo();this.mesh.computeWorldMatrix(!0),this.setLocalAxes(this.mesh),this.callActionStartListener(t),this.callActionListener(t),this.callActionEndListener(t)},t.prototype.redo=function(){var t=this.actHist.redo();this.mesh.computeWorldMatrix(!0),this.setLocalAxes(this.mesh),this.callActionStartListener(t),this.callActionListener(t),this.callActionEndListener(t)},t.prototype.detach=function(){this.canvas.removeEventListener("pointerdown",this.pointerdown,!1),this.canvas.removeEventListener("pointerup",this.pointerup,!1),this.canvas.removeEventListener("pointermove",this.pointermove,!1),this.scene.unregisterBeforeRender(this.renderer),this.removeAllActionListeners(),this.disposeAll()},t.prototype.hide=function(){this.hidden=!0,this.transEnabled?(this.prevState="T",this.disableTranslation()):this.rotEnabled?(this.prevState="R",this.disableRotation()):this.scaleEnabled&&(this.prevState="S",this.disableScaling()),this.hideCommonAxes()},t.prototype.hideCommonAxes=function(){this.xaxis.visibility=0,this.yaxis.visibility=0,this.zaxis.visibility=0},t.prototype.showCommonAxes=function(){this.xaxis.visibility=this.visibility,this.yaxis.visibility=this.visibility,this.zaxis.visibility=this.visibility},t.prototype.show=function(){this.hidden=!1,this.showCommonAxes(),"T"==this.prevState?this.enableTranslation():"R"==this.prevState?this.enableRotation():"S"==this.prevState&&this.enableScaling()},t.prototype.isHidden=function(){return this.hidden},t.prototype.disposeAll=function(){this.ecRoot.dispose(),this.disposeMaterials(),this.actHist=null},t.prototype.addActionListener=function(t){this.actionListener=t},t.prototype.removeActionListener=function(){this.actionListener=null},t.prototype.addActionStartListener=function(t){this.actionStartListener=t},t.prototype.removeActionStartListener=function(){this.actionStartListener=null},t.prototype.addActionEndListener=function(t){this.actionEndListener=t},t.prototype.removeActionEndListener=function(){this.actionEndListener=null},t.prototype.removeAllActionListeners=function(){this.actionListener=null,this.actionStartListener=null,this.actionEndListener=null},t.prototype.onPointerDown=function(t){var i=this;if(t.preventDefault(),this.pDown=!0,0==t.button){var s=this.scene.pick(this.scene.pointerX,this.scene.pointerY,function(t){if(i.transEnabled){if(t==i.tX||t==i.tY||t==i.tZ||t==i.tXZ||t==i.tZY||t==i.tYX||t==i.tAll)return!0}else if(i.rotEnabled){if(t==i.rX||t==i.rY||t==i.rZ||t==i.rAll)return!0}else if(i.scaleEnabled&&(t==i.sX||t==i.sY||t==i.sZ||t==i.sXZ||t==i.sZY||t==i.sYX||t==i.sAll))return!0;return!1},null,this.mainCamera);if(s.hit){this.axisPicked=s.pickedMesh;var e=this.axisPicked.getChildren();e.length>0?e[0].visibility=this.visibility:this.axisPicked.visibility=this.visibility;var n=this.axisPicked.name;"X"==n?this.bXaxis.visibility=1:"Y"==n?this.bYaxis.visibility=1:"Z"==n?this.bZaxis.visibility=1:"XZ"==n?(this.bXaxis.visibility=1,this.bZaxis.visibility=1):"ZY"==n?(this.bZaxis.visibility=1,this.bYaxis.visibility=1):"YX"==n?(this.bYaxis.visibility=1,this.bXaxis.visibility=1):"ALL"==n&&(this.bXaxis.visibility=1,this.bYaxis.visibility=1,this.bZaxis.visibility=1),this.setEditing(!0),this.pickedPlane=this.getPickPlane(this.axisPicked),null!=this.pickedPlane?this.prevPos=this.getPosOnPickPlane():this.prevPos=null,window.setTimeout(function(t,s){return i.detachCamera(t,s)},0,this.mainCamera,this.canvas)}}},t.prototype.setEditing=function(t){this.editing=t,t?(this.setActionType(),this.callActionStartListener(this.actionType)):this.callActionEndListener(this.actionType)},t.prototype.isEditing=function(){return this.editing},t.prototype.detachCamera=function(t,i){var s=t,e=i;s.detachControl(e)},t.prototype.isPointerOver=function(){return this.pointerIsOver},t.prototype.onPointerOver=function(){var t=this,i=this.scene.pick(this.scene.pointerX,this.scene.pointerY,function(i){if(t.transEnabled){if(i==t.tX||i==t.tY||i==t.tZ||i==t.tXZ||i==t.tZY||i==t.tYX||i==t.tAll)return!0}else if(t.rotEnabled){if(i==t.rX||i==t.rY||i==t.rZ||i==t.rAll)return!0}else if(t.scaleEnabled&&(i==t.sX||i==t.sY||i==t.sZ||i==t.sXZ||i==t.sZY||i==t.sYX||i==t.sAll))return!0;return!1},null,this.mainCamera);if(i.hit){if(i.pickedMesh!=this.prevOverMesh){if(this.pointerIsOver=!0,this.clearPrevOverMesh(),this.prevOverMesh=i.pickedMesh,this.rotEnabled)this.savedCol=this.prevOverMesh.getChildren()[0].color,this.prevOverMesh.getChildren()[0].color=e.White();else{var s=this.prevOverMesh.getChildren();s.length>0?(this.savedMat=s[0].material,s[0].material=this.whiteMat):(this.savedMat=this.prevOverMesh.material,this.prevOverMesh.material=this.whiteMat)}"X"==this.prevOverMesh.name?this.xaxis.color=e.White():"Y"==this.prevOverMesh.name?this.yaxis.color=e.White():"Z"==this.prevOverMesh.name&&(this.zaxis.color=e.White())}}else this.pointerIsOver=!1,null!=this.prevOverMesh&&(this.restoreColor(this.prevOverMesh),this.prevOverMesh=null)},t.prototype.clearPrevOverMesh=function(){null!=this.prevOverMesh&&(this.prevOverMesh.visibility=0,this.restoreColor(this.prevOverMesh))},t.prototype.restoreColor=function(t){switch(t.name){case"X":this.xaxis.color=e.Red();break;case"Y":this.yaxis.color=e.Green();break;case"Z":this.zaxis.color=e.Blue()}if(this.rotEnabled)t.getChildren()[0].color=this.savedCol;else{var i=t.getChildren();i.length>0?i[0].material=this.savedMat:t.material=this.savedMat}},t.prototype.onPointerUp=function(t){this.pDown=!1,this.editing&&(this.mainCamera.attachControl(this.canvas),this.setEditing(!1),this.hideBaxis(),null!=this.prevOverMesh&&(this.restoreColor(this.prevOverMesh),this.prevOverMesh=null),this.actHist.add(this.actionType))},t.prototype.setActionType=function(){this.transEnabled?this.actionType=i.TRANS:this.rotEnabled?this.actionType=i.ROT:this.scaleEnabled&&(this.actionType=i.SCALE)},t.prototype.callActionListener=function(t){null!=this.actionListener&&this.actionListener(t)},t.prototype.callActionStartListener=function(t){null!=this.actionStartListener&&this.actionStartListener(t)},t.prototype.callActionEndListener=function(t){null!=this.actionEndListener&&this.actionEndListener(t)},t.prototype.onPointerMove=function(t){if(!this.pDown)return void this.onPointerOver();if(this.editing&&null!=this.prevPos){var i=this.getPosOnPickPlane();if(null!=i){if(this.rotEnabled)this.doRotation(this.mesh,this.axisPicked,i,this.prevPos);else{var s=i.subtract(this.prevPos);if(0==s.x&&0==s.y&&0==s.z)return;this.transEnabled?this.doTranslation(s):this.scaleEnabled&&this.local&&this.doScaling(s)}this.prevPos=i,this.callActionListener(this.actionType)}}},t.prototype.getPickPlane=function(t){var i=t.name;if(this.transEnabled||this.scaleEnabled){if("XZ"==i)return this.pXZ;if("ZY"==i)return this.pZY;if("YX"==i)return this.pYX;if("ALL"==i)return this.pALL;this.ecRoot.getWorldMatrix().invertToRef(this.ecMatrix),p.TransformCoordinatesToRef(this.mainCamera.position,this.ecMatrix,this.ecTOcamera);var s=this.ecTOcamera;if("X"===i)return Math.abs(s.y)>Math.abs(s.z)?this.pXZ:this.pYX;if("Z"===i)return Math.abs(s.y)>Math.abs(s.x)?this.pXZ:this.pZY;if("Y"===i)return Math.abs(s.z)>Math.abs(s.x)?this.pYX:this.pZY}else{if(!this.rotEnabled)return null;this.rotate2=!1,this.ecRoot.getWorldMatrix().invertToRef(this.ecMatrix),p.TransformCoordinatesToRef(this.mainCamera.position,this.ecMatrix,this.ecTOcamera);var s=this.ecTOcamera;switch(i){case"X":return Math.abs(s.x)<.2?(this.rotate2=!0,this.pALL):this.pZY;case"Y":return Math.abs(s.y)<.2?(this.rotate2=!0,this.pALL):this.pXZ;case"Z":return Math.abs(s.z)<.2?(this.rotate2=!0,this.pALL):this.pYX;default:return this.pALL}}},t.prototype.doTranslation=function(t){var i=this.axisPicked.name;"ALL"==i?this.transBy=t:(this.transBy.x=0,this.transBy.y=0,this.transBy.z=0,"X"!=i&&"XZ"!=i&&"YX"!=i||(this.local?this.transBy.x=p.Dot(t,this.localX)/this.localX.length():this.transBy.x=t.x),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.local?this.transBy.y=p.Dot(t,this.localY)/this.localY.length():this.transBy.y=t.y),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.local?this.transBy.z=p.Dot(t,this.localZ)/this.localZ.length():this.transBy.z=t.z)),this.transWithSnap(this.mesh,this.transBy,this.local),this.transBoundsMin&&(this.mesh.position.x=Math.max(this.mesh.position.x,this.transBoundsMin.x),this.mesh.position.y=Math.max(this.mesh.position.y,this.transBoundsMin.y),this.mesh.position.z=Math.max(this.mesh.position.z,this.transBoundsMin.z)),this.transBoundsMax&&(this.mesh.position.x=Math.min(this.mesh.position.x,this.transBoundsMax.x),this.mesh.position.y=Math.min(this.mesh.position.y,this.transBoundsMax.y),this.mesh.position.z=Math.min(this.mesh.position.z,this.transBoundsMax.z)),this.mesh.computeWorldMatrix(!0)},t.prototype.transWithSnap=function(t,i,s){if(this.snapT){var e=!1;if(this.snapTV.addInPlace(i),Math.abs(this.snapTV.x)>this.tSnap.x&&(this.snapTV.x>0?i.x=this.tSnap.x:i.x=-this.tSnap.x,e=!0),Math.abs(this.snapTV.y)>this.tSnap.y&&(this.snapTV.y>0?i.y=this.tSnap.y:i.y=-this.tSnap.y,e=!0),Math.abs(this.snapTV.z)>this.tSnap.z&&(this.snapTV.z>0?i.z=this.tSnap.z:i.z=-this.tSnap.z,e=!0),!e)return;Math.abs(i.x)!==this.tSnap.x&&(i.x=0),Math.abs(i.y)!==this.tSnap.y&&(i.y=0),Math.abs(i.z)!==this.tSnap.z&&(i.z=0),p.FromFloatsToRef(0,0,0,this.snapTV),e=!1}s?(this.localX.normalizeToRef(this.tv1),this.localY.normalizeToRef(this.tv2),this.localZ.normalizeToRef(this.tv3),this.mesh.translate(this.tv1,i.x,l.WORLD),this.mesh.translate(this.tv2,i.y,l.WORLD),this.mesh.translate(this.tv3,i.z,l.WORLD)):null==this.mesh.parent?this.mesh.position.addInPlace(i):this.mesh.setAbsolutePosition(i.addInPlace(this.mesh.absolutePosition))},t.prototype.doScaling=function(t){this.scale.x=0,this.scale.y=0,this.scale.z=0;var i=this.axisPicked.name;"X"!=i&&"XZ"!=i&&"YX"!=i||(this.scale.x=p.Dot(t,this.localX)/this.localX.length(),this.mesh.scaling.x<0&&(this.scale.x=-this.scale.x)),"Y"!=i&&"ZY"!=i&&"YX"!=i||(this.scale.y=p.Dot(t,this.localY)/this.localY.length(),this.mesh.scaling.y<0&&(this.scale.y=-this.scale.y)),"Z"!=i&&"XZ"!=i&&"ZY"!=i||(this.scale.z=p.Dot(t,this.localZ)/this.localZ.length(),this.mesh.scaling.z<0&&(this.scale.z=-this.scale.z));var s=this.boundingDimesion;if(this.scale.x=this.scale.x/s.x,this.scale.y=this.scale.y/s.y,this.scale.z=this.scale.z/s.z,"ALL"==i){var e=p.Dot(t,this.mainCamera.upVector);e/=Math.max(s.x,s.y,s.z),this.lhsRhs?this.scale.copyFromFloats(e,-e,e):this.scale.copyFromFloats(e,e,e)}else{var n=!1;if("XZ"==i?(n=!0,Math.abs(this.scale.x)>Math.abs(this.scale.z)?this.scale.z=this.scale.x:this.scale.x=this.scale.z):"ZY"==i?(n=!0,Math.abs(this.scale.z)>Math.abs(this.scale.y)?this.scale.y=this.scale.z:this.scale.z=this.scale.y):"YX"==i&&(n=!0,Math.abs(this.scale.y)>Math.abs(this.scale.x)?this.scale.x=this.scale.y:this.scale.y=this.scale.x),n){this.ecRoot.position.subtractToRef(this.mainCamera.position,this.cameraTOec);var e=p.Dot(t,this.cameraTOec);this.scale.x=Math.abs(this.scale.x),this.scale.y=Math.abs(this.scale.y),this.scale.z=Math.abs(this.scale.z),e>0?(this.mesh.scaling.x>0&&(this.scale.x=-this.scale.x),this.mesh.scaling.y>0&&(this.scale.y=-this.scale.y),this.mesh.scaling.z>0&&(this.scale.z=-this.scale.z)):(this.mesh.scaling.x<0&&(this.scale.x=-this.scale.x),this.mesh.scaling.y<0&&(this.scale.y=-this.scale.y),this.mesh.scaling.z<0&&(this.scale.z=-this.scale.z))}}this.scaleWithSnap(this.mesh,this.scale),this.scaleBoundsMin&&(this.mesh.scaling.x=Math.max(this.mesh.scaling.x,this.scaleBoundsMin.x),this.mesh.scaling.y=Math.max(this.mesh.scaling.y,this.scaleBoundsMin.y),this.mesh.scaling.z=Math.max(this.mesh.scaling.z,this.scaleBoundsMin.z)),this.scaleBoundsMax&&(this.mesh.scaling.x=Math.min(this.mesh.scaling.x,this.scaleBoundsMax.x),this.mesh.scaling.y=Math.min(this.mesh.scaling.y,this.scaleBoundsMax.y),this.mesh.scaling.z=Math.min(this.mesh.scaling.z,this.scaleBoundsMax.z)),this.setLocalAxes(this.mesh)},t.prototype.scaleWithSnap=function(t,i){if(this.snapS){var s=!1;if(this.snapSV.addInPlace(i),Math.abs(this.snapSV.x)>this.scaleSnap&&(i.x>0?i.x=this.scaleSnap:i.x=-this.scaleSnap,s=!0),Math.abs(this.snapSV.y)>this.scaleSnap&&(i.y>0?i.y=this.scaleSnap:i.y=-this.scaleSnap,s=!0),Math.abs(this.snapSV.z)>this.scaleSnap&&(i.z>0?i.z=this.scaleSnap:i.z=-this.scaleSnap,s=!0),!s)return;Math.abs(i.x)!==this.scaleSnap&&0!==i.x&&(i.x=0),Math.abs(i.y)!==this.scaleSnap&&0!==i.y&&(i.y=0),Math.abs(i.z)!==this.scaleSnap&&0!==i.z&&(i.z=0),p.FromFloatsToRef(0,0,0,this.snapSV),s=!1}t.scaling.addInPlace(i)},t.prototype.getBoundingDimension=function(t){var i=t.getBoundingInfo().boundingBox,s=i.maximum.subtract(i.minimum);return 0==s.x&&(s.x=1),0==s.y&&(s.y=1),0==s.z&&(s.z=1),s},t.prototype.refreshBoundingInfo=function(){this.boundingDimesion=this.getBoundingDimension(this.mesh)},t.prototype.doRotation=function(t,i,e,n){var h,a=0;i==this.rX?h=this.local?this.localX:s.X:i==this.rY?h=this.local?this.localY:s.Y:i==this.rZ&&(h=this.local?this.localZ:s.Z),this.ecRoot.position.subtractToRef(this.mainCamera.position,this.cameraTOec),a=this.rotate2?this.getAngle2(n,e,this.mainCamera.position,this.cameraTOec,h):this.getAngle(n,e,t.getAbsolutePivotPoint(),this.cameraTOec),this.cameraTOec.normalize(),i==this.rX?(this.snapR&&(this.snapRX+=a,a=0,Math.abs(this.snapRX)>=this.rotSnap&&(a=this.snapRX>0?this.rotSnap:-this.rotSnap,this.snapRX=0)),0!==a&&(p.Dot(h,this.cameraTOec)>=0&&(a*=-1),t.rotate(h,a,l.WORLD))):i==this.rY?(this.snapR&&(this.snapRY+=a,a=0,Math.abs(this.snapRY)>=this.rotSnap&&(a=this.snapRY>0?this.rotSnap:-this.rotSnap,this.snapRY=0)),0!==a&&0!==a&&(p.Dot(h,this.cameraTOec)>=0&&(a*=-1),t.rotate(h,a,l.WORLD))):i==this.rZ?(this.snapR&&(this.snapRZ+=a,a=0,Math.abs(this.snapRZ)>=this.rotSnap&&(a=this.snapRZ>0?this.rotSnap:-this.rotSnap,this.snapRZ=0)),0!==a&&0!==a&&(p.Dot(h,this.cameraTOec)>=0&&(a*=-1),t.rotate(h,a,l.WORLD))):i==this.rAll&&(this.snapR&&(this.snapRA+=a,a=0,Math.abs(this.snapRA)>=this.rotSnap&&(a=this.snapRA>0?this.rotSnap:-this.rotSnap,this.snapRA=0)),0!==a&&t.rotate(this.cameraTOec,-a,l.WORLD)),this.setLocalAxes(this.mesh),this.eulerian&&0!=a&&(t.rotation=t.rotationQuaternion.toEulerAngles(),t.rotationQuaternion=null)},t.prototype.getPosOnPickPlane=function(){var t=this,i=this.scene.pick(this.scene.pointerX,this.scene.pointerY,function(i){return i==t.pickedPlane},null,this.mainCamera);return i.hit?i.pickedPoint:null},t.prototype.hideBaxis=function(){this.bXaxis.visibility=0,this.bYaxis.visibility=0,this.bZaxis.visibility=0},t.prototype.setAxesVisiblity=function(t){this.transEnabled&&(this.tEndX.visibility=t,this.tEndY.visibility=t,this.tEndZ.visibility=t,this.tEndXZ.visibility=t,this.tEndZY.visibility=t,this.tEndYX.visibility=t,this.tEndAll.visibility=t),this.rotEnabled&&(this.rEndX.visibility=t,this.rEndY.visibility=t,this.rEndZ.visibility=t,this.rEndAll.visibility=t),this.scaleEnabled&&(this.sEndX.visibility=t,this.sEndY.visibility=t,this.sEndZ.visibility=t,this.sEndXZ.visibility=t,this.sEndZY.visibility=t,this.sEndYX.visibility=t,this.sEndAll.visibility=t)},t.prototype.getRotationQuaternion=function(){return this.ecRoot.rotationQuaternion},t.prototype.getPosition=function(){return this.ecRoot.position},t.prototype.isTranslationEnabled=function(){return this.transEnabled},t.prototype.enableTranslation=function(){null==this.tX&&(this.createTransAxes(),this.tCtl.parent=this.ecRoot),this.clearPrevOverMesh(),this.transEnabled||(this.tEndX.visibility=this.visibility,this.tEndY.visibility=this.visibility,this.tEndZ.visibility=this.visibility,this.tEndXZ.visibility=this.visibility,this.tEndZY.visibility=this.visibility,this.tEndYX.visibility=this.visibility,this.tEndAll.visibility=this.visibility,this.transEnabled=!0,this.disableRotation(),this.disableScaling())},t.prototype.disableTranslation=function(){this.transEnabled&&(this.tEndX.visibility=0,this.tEndY.visibility=0,this.tEndZ.visibility=0,this.tEndXZ.visibility=0,this.tEndZY.visibility=0,this.tEndYX.visibility=0,this.tEndAll.visibility=0,this.transEnabled=!1)},t.prototype.isRotationEnabled=function(){return this.rotEnabled},t.prototype.returnEuler=function(t){this.eulerian=t},t.prototype.enableRotation=function(){null==this.rCtl&&(this.createRotAxes(),this.rCtl.parent=this.ecRoot),this.clearPrevOverMesh(),this.rotEnabled||(this.rEndX.visibility=this.visibility,this.rEndY.visibility=this.visibility,this.rEndZ.visibility=this.visibility,this.rEndAll.visibility=this.visibility,this.rEndAll2.visibility=this.visibility,this.rotEnabled=!0,this.disableTranslation(),this.disableScaling())},t.prototype.disableRotation=function(){this.rotEnabled&&(this.rEndX.visibility=0,this.rEndY.visibility=0,this.rEndZ.visibility=0,this.rEndAll.visibility=0,this.rEndAll2.visibility=0,this.rotEnabled=!1)},t.prototype.isScalingEnabled=function(){return this.scaleEnabled},t.prototype.enableScaling=function(){null==this.sX&&(this.createScaleAxes(),this.sCtl.parent=this.ecRoot),this.clearPrevOverMesh(),this.scaleEnabled||(this.sEndX.visibility=this.visibility,this.sEndY.visibility=this.visibility,this.sEndZ.visibility=this.visibility,this.sEndXZ.visibility=this.visibility,this.sEndZY.visibility=this.visibility,this.sEndYX.visibility=this.visibility,this.sEndAll.visibility=this.visibility,this.scaleEnabled=!0,this.disableTranslation(),this.disableRotation())},t.prototype.disableScaling=function(){this.scaleEnabled&&(this.sEndX.visibility=0,this.sEndY.visibility=0,this.sEndZ.visibility=0,this.sEndXZ.visibility=0,this.sEndZY.visibility=0,this.sEndYX.visibility=0,this.sEndAll.visibility=0,this.scaleEnabled=!1)},t.prototype.setScaleBounds=function(t,i){this.scaleBoundsMin=t||null,this.scaleBoundsMax=i||null,null!=this.scaleBoundsMin&&(0==this.scaleBoundsMin.x&&(this.scaleBoundsMin.x=1e-8),0==this.scaleBoundsMin.y&&(this.scaleBoundsMin.y=1e-8),0==this.scaleBoundsMin.z&&(this.scaleBoundsMin.z=1e-8))},t.prototype.removeScaleBounds=function(){this.scaleBoundsMin=null,this.scaleBoundsMax=null},t.prototype.setTransBounds=function(t,i){this.transBoundsMin=t||null,this.transBoundsMax=i||null},t.prototype.removeTransBounds=function(){this.transBoundsMin=null,this.transBoundsMax=null},t.prototype.setRotBounds=function(t,i){this.rotBoundsMin=t||null,this.rotBoundsMax=i||null},t.prototype.removeRotBounds=function(){this.rotBoundsMin=null,this.rotBoundsMax=null},t.prototype.createCommonAxes=function(){var t=new h("guideCtl",this.scene);this.bXaxis=h.CreateLines("bxAxis",[new p(-100,0,0),new p(100,0,0)],this.scene),this.bYaxis=h.CreateLines("byAxis",[new p(0,-100,0),new p(0,100,0)],this.scene),this.bZaxis=h.CreateLines("bzAxis",[new p(0,0,-100),new p(0,0,100)],this.scene),this.bXaxis.isPickable=!1,this.bYaxis.isPickable=!1,this.bZaxis.isPickable=!1,this.bXaxis.parent=t,this.bYaxis.parent=t,this.bZaxis.parent=t,this.bXaxis.color=e.Red(),this.bYaxis.color=e.Green(),this.bZaxis.color=e.Blue(),this.hideBaxis();var i=this.axesLen*this.axesScale*.75;return this.lhsRhs?this.xaxis=h.CreateLines("xAxis",[new p(0,0,0),new p(-i,0,0)],this.scene):this.xaxis=h.CreateLines("xAxis",[new p(0,0,0),new p(i,0,0)],this.scene),this.yaxis=h.CreateLines("yAxis",[new p(0,0,0),new p(0,i,0)],this.scene),this.zaxis=h.CreateLines("zAxis",[new p(0,0,0),new p(0,0,i)],this.scene),this.xaxis.isPickable=!1,this.yaxis.isPickable=!1,this.zaxis.isPickable=!1,this.xaxis.parent=t,this.yaxis.parent=t,this.zaxis.parent=t,this.xaxis.color=e.Red(),this.yaxis.color=e.Green(),this.zaxis.color=e.Blue(),this.xaxis.renderingGroupId=1,this.yaxis.renderingGroupId=1,this.zaxis.renderingGroupId=1,t},t.prototype.createPickPlanes=function(){this.pALL=h.CreatePlane("pALL",5,this.scene),this.pXZ=h.CreatePlane("pXZ",5,this.scene),this.pZY=h.CreatePlane("pZY",5,this.scene),this.pYX=h.CreatePlane("pYX",5,this.scene),this.pALL.isPickable=!1,this.pXZ.isPickable=!1,this.pZY.isPickable=!1,this.pYX.isPickable=!1,this.pALL.visibility=0,this.pXZ.visibility=0,this.pZY.visibility=0,this.pYX.visibility=0,this.pALL.renderingGroupId=1,this.pXZ.renderingGroupId=1,this.pZY.renderingGroupId=1,this.pYX.renderingGroupId=1,this.pALL.lookAt(this.mainCamera.position),this.pXZ.rotate(s.X,1.57),this.pZY.rotate(s.Y,1.57);var t=new h("pickPlanes",this.scene);return this.pALL.parent=t,this.pXZ.parent=t,this.pZY.parent=t,this.pYX.parent=t,t},t.prototype.createTransAxes=function(){var t=2*this.pickWidth*this.axesScale,i=this.axesLen*this.axesScale;this.tCtl=new h("tarnsCtl",this.scene),this.tX=this.extrudeBox(t/2,i),this.tX.name="X",this.tY=this.tX.clone("Y"),this.tZ=this.tX.clone("Z"),this.tXZ=a.CreatePlane("XZ",{size:2*t},this.scene),this.tZY=a.CreatePlane("ZY",{size:2*t},this.scene),this.tYX=a.CreatePlane("YX",{size:2*t},this.scene),this.tXZ.rotation.x=1.57,this.tZY.rotation.y=-1.57,this.tXZ.position.x=t,this.tXZ.position.z=t,this.tZY.position.z=t,this.tZY.position.y=t,this.tYX.position.y=t,this.tYX.position.x=t,this.tXZ.bakeCurrentTransformIntoVertices(),this.tZY.bakeCurrentTransformIntoVertices(),this.tYX.bakeCurrentTransformIntoVertices(),this.tAll=h.CreateBox("ALL",2*t,this.scene),this.tX.parent=this.tCtl,this.tY.parent=this.tCtl,this.tZ.parent=this.tCtl,this.tXZ.parent=this.tCtl,this.tZY.parent=this.tCtl,this.tYX.parent=this.tCtl,this.tAll.parent=this.tCtl,this.lhsRhs?this.tX.rotation.y=-1.57:this.tX.rotation.y=1.57,this.tY.rotation.x-=1.57,this.tX.visibility=0,this.tY.visibility=0,this.tZ.visibility=0,this.tXZ.visibility=0,this.tZY.visibility=0,this.tYX.visibility=0,this.tAll.visibility=0,this.tX.isPickable=!1,this.tY.isPickable=!1,this.tZ.isPickable=!1,this.tXZ.isPickable=!1,this.tZY.isPickable=!1,this.tYX.isPickable=!1,this.tAll.isPickable=!1;var s=i/5,e=t;this.tEndX=h.CreateCylinder("tEndX",s,0,e,6,1,this.scene),this.tEndY=this.tEndX.clone("tEndY"),this.tEndZ=this.tEndX.clone("tEndZ"),this.tEndXZ=this.createTriangle("XZ",1.75*e,this.scene),this.tEndZY=this.tEndXZ.clone("ZY"),this.tEndYX=this.tEndXZ.clone("YX"),this.tEndAll=a.CreatePolyhedron("tEndAll",{type:1,size:e/2},this.scene),this.tEndX.rotation.x=1.57,this.tEndY.rotation.x=1.57,this.tEndZ.rotation.x=1.57,this.tEndZY.rotation.z=1.57,this.tEndYX.rotation.x=-1.57,this.tEndXZ.position.x=t,this.tEndXZ.position.z=t,this.tEndZY.position.z=t,this.tEndZY.position.y=t,this.tEndYX.position.y=t,this.tEndYX.position.x=t,this.tEndX.parent=this.tX,this.tEndY.parent=this.tY,this.tEndZ.parent=this.tZ,this.tEndXZ.parent=this.tXZ,this.tEndZY.parent=this.tZY,this.tEndYX.parent=this.tYX,this.tEndAll.parent=this.tAll,this.tEndX.position.z=i-s/2,this.tEndY.position.z=i-s/2,this.tEndZ.position.z=i-s/2,this.tEndX.material=this.redMat,this.tEndY.material=this.greenMat,this.tEndZ.material=this.blueMat,this.tEndXZ.material=this.greenMat,this.tEndZY.material=this.redMat,this.tEndYX.material=this.blueMat,this.tEndAll.material=this.yellowMat,this.tEndX.renderingGroupId=2,this.tEndY.renderingGroupId=2,this.tEndZ.renderingGroupId=2,this.tEndXZ.renderingGroupId=2,this.tEndZY.renderingGroupId=2,this.tEndYX.renderingGroupId=2,this.tEndAll.renderingGroupId=2,this.tEndX.isPickable=!1,this.tEndY.isPickable=!1,this.tEndZ.isPickable=!1,this.tEndXZ.isPickable=!1,this.tEndZY.isPickable=!1,this.tEndYX.isPickable=!1,this.tEndAll.isPickable=!1},t.prototype.createTriangle=function(t,i,s){var e=new o(i/2,-i/2).addLineTo(i/2,i/2).addLineTo(-i/2,i/2).addLineTo(i/2,-i/2);return new BABYLON.PolygonMeshBuilder(t,e,s).build()},t.prototype.setRotGuideFull=function(t){this.guideSize=t?360:180,null!=this.rCtl&&(this.rCtl.dispose(),this.rAll.dispose(),this.rCtl=null,this.enableRotation())},t.prototype.createRotAxes=function(){var t=this.axesLen*this.axesScale*2;this.rCtl=new h("rotCtl",this.scene),this.rX=this.createTube(t/2,this.guideSize),this.rX.name="X",this.rY=this.createTube(t/2,this.guideSize),this.rY.name="Y",this.rZ=this.createTube(t/2,this.guideSize),this.rZ.name="Z",this.rAll=this.createTube(t/1.75,360),this.rAll.name="ALL",this.rX.rotation.z=1.57,this.rZ.rotation.x=-1.57,this.rX.bakeCurrentTransformIntoVertices(),this.rZ.bakeCurrentTransformIntoVertices(),this.rAll.rotation.x=1.57,this.rX.parent=this.rCtl,this.rY.parent=this.rCtl,this.rZ.parent=this.rCtl,this.rAll.parent=this.pALL,this.rX.visibility=0,this.rY.visibility=0,this.rZ.visibility=0,this.rAll.visibility=0,this.rX.isPickable=!1,this.rY.isPickable=!1,this.rZ.isPickable=!1,this.rAll.isPickable=!1;var i=t;this.rEndX=this.createCircle(i/2,this.guideSize,!1),this.rEndY=this.rEndX.clone(""),this.rEndZ=this.rEndX.clone(""),this.rEndAll=this.createCircle(i/1.75,360,!1),this.rEndAll2=this.createCircle(i/2,360,!1),this.rEndX.parent=this.rX,this.rEndY.parent=this.rY,this.rEndZ.parent=this.rZ,this.rEndX.rotation.z=1.57,this.rEndZ.rotation.x=-1.57,this.rEndAll.parent=this.rAll,this.rEndAll2.parent=this.rAll,this.rEndX.color=e.Red(),this.rEndY.color=e.Green(),this.rEndZ.color=e.Blue(),this.rEndAll.color=e.Yellow(),this.rEndAll2.color=e.Gray(),this.rEndX.renderingGroupId=2,this.rEndY.renderingGroupId=2,this.rEndZ.renderingGroupId=2,this.rEndAll.renderingGroupId=2,this.rEndAll2.renderingGroupId=2,this.rEndX.isPickable=!1,this.rEndY.isPickable=!1,this.rEndZ.isPickable=!1,this.rEndAll.isPickable=!1},t.prototype.extrudeBox=function(t,i){var s=[new p(t,t,0),new p(-t,t,0),new p(-t,-t,0),new p(t,-t,0),new p(t,t,0)],e=[new p(0,0,0),new p(0,0,i)];return h.ExtrudeShape("",s,e,1,0,2,this.scene)},t.prototype.createCircle=function(t,i,s){null===i&&(i=360);for(var e,n,a=[],o=3.14/180,r=0,l=0;l<=i;l+=5)e=t*Math.cos(l*o),n=90==l?t:270==l?-t:t*Math.sin(l*o),a[r]=new p(e,0,n),r++;if(s){t-=.04;for(var l=0;l<=i;l+=5)e=t*Math.cos(l*o),n=90==l?t:270==l?-t:t*Math.sin(l*o),a[r]=new p(e,0,n),r++}return h.CreateLines("",a,this.scene)},t.prototype.createTube=function(t,i){null===i&&(i=360);for(var s,e,n=[],a=3.14/180,o=0,r=0;r<=i;r+=30)s=t*Math.cos(r*a),e=90==r?t:270==r?-t:t*Math.sin(r*a),n[o]=new p(s,0,e),o++;return h.CreateTube("",n,this.pickWidth*this.axesScale*2,3,null,BABYLON.Mesh.NO_CAP,this.scene)},t.prototype.createScaleAxes=function(){var t=2*this.pickWidth*this.axesScale,i=this.axesLen*this.axesScale;this.sCtl=new h("sCtl",this.scene),this.sX=this.extrudeBox(t/2,i),this.sX.name="X",this.sY=this.sX.clone("Y"),this.sZ=this.sX.clone("Z"),this.sXZ=a.CreatePlane("XZ",{size:2*t},this.scene),this.sZY=a.CreatePlane("ZY",{size:2*t},this.scene),this.sYX=a.CreatePlane("YX",{size:2*t},this.scene),this.sXZ.rotation.x=1.57,this.sZY.rotation.y=-1.57,this.sXZ.position.x=t,this.sXZ.position.z=t,this.sZY.position.z=t,this.sZY.position.y=t,this.sYX.position.y=t,this.sYX.position.x=t,this.sXZ.bakeCurrentTransformIntoVertices(),this.sZY.bakeCurrentTransformIntoVertices(),this.sYX.bakeCurrentTransformIntoVertices(),this.sAll=h.CreateBox("ALL",2*t,this.scene),this.sX.parent=this.sCtl,this.sY.parent=this.sCtl,this.sZ.parent=this.sCtl,this.sAll.parent=this.sCtl,this.sXZ.parent=this.sCtl,
this.sZY.parent=this.sCtl,this.sYX.parent=this.sCtl,this.lhsRhs?this.sX.rotation.y=-1.57:this.sX.rotation.y=1.57,this.sY.rotation.x-=1.57,this.sX.visibility=0,this.sY.visibility=0,this.sZ.visibility=0,this.sXZ.visibility=0,this.sZY.visibility=0,this.sYX.visibility=0,this.sAll.visibility=0,this.sX.isPickable=!1,this.sY.isPickable=!1,this.sZ.isPickable=!1,this.sXZ.isPickable=!1,this.sZY.isPickable=!1,this.sYX.isPickable=!1,this.sAll.isPickable=!1;var s=t;this.sEndX=h.CreateBox("",s,this.scene),this.sEndY=this.sEndX.clone(""),this.sEndZ=this.sEndX.clone(""),this.sEndXZ=this.createTriangle("XZ",1.75*s,this.scene),this.sEndZY=this.sEndXZ.clone("ZY"),this.sEndYX=this.sEndXZ.clone("YX"),this.sEndAll=a.CreatePolyhedron("sEndAll",{type:1,size:s/2},this.scene),this.sEndZY.rotation.z=1.57,this.sEndYX.rotation.x=-1.57,this.sEndXZ.position.x=t,this.sEndXZ.position.z=t,this.sEndZY.position.z=t,this.sEndZY.position.y=t,this.sEndYX.position.y=t,this.sEndYX.position.x=t,this.sEndX.parent=this.sX,this.sEndY.parent=this.sY,this.sEndZ.parent=this.sZ,this.sEndXZ.parent=this.sXZ,this.sEndZY.parent=this.sZY,this.sEndYX.parent=this.sYX,this.sEndAll.parent=this.sAll,this.sEndX.position.z=i-s/2,this.sEndY.position.z=i-s/2,this.sEndZ.position.z=i-s/2,this.sEndX.material=this.redMat,this.sEndY.material=this.greenMat,this.sEndZ.material=this.blueMat,this.sEndXZ.material=this.greenMat,this.sEndZY.material=this.redMat,this.sEndYX.material=this.blueMat,this.sEndAll.material=this.yellowMat,this.sEndX.renderingGroupId=2,this.sEndY.renderingGroupId=2,this.sEndZ.renderingGroupId=2,this.sEndXZ.renderingGroupId=2,this.sEndZY.renderingGroupId=2,this.sEndYX.renderingGroupId=2,this.sEndAll.renderingGroupId=2,this.sEndX.isPickable=!1,this.sEndY.isPickable=!1,this.sEndZ.isPickable=!1,this.sEndXZ.isPickable=!1,this.sEndZY.isPickable=!1,this.sEndYX.isPickable=!1,this.sEndAll.isPickable=!1},t.prototype.setLocalAxes=function(t){var i=t.getWorldMatrix();p.FromFloatArrayToRef(i.m,0,this.localX),p.FromFloatArrayToRef(i.m,4,this.localY),p.FromFloatArrayToRef(i.m,8,this.localZ)},t.prototype.check_LHS_RHS=function(t){var i=p.Cross(this.localX,this.localY);return p.Dot(i,this.localZ)<0},t.prototype.setVisibility=function(t){this.visibility=t},t.prototype.setLocal=function(t){this.local!=t&&(this.local=t,t||(this.ecRoot.rotationQuaternion=r.Identity()))},t.prototype.isLocal=function(){return this.local},t.prototype.setTransSnap=function(t){this.snapT=t},t.prototype.setRotSnap=function(t){this.snapR=t},t.prototype.setScaleSnap=function(t){this.snapS=t},t.prototype.setTransSnapValue=function(t){this.tSnap.copyFromFloats(t,t,t),this.transSnap=t},t.prototype.setRotSnapValue=function(t){this.rotSnap=t},t.prototype.setScaleSnapValue=function(t){this.scaleSnap=t},t.prototype.getAngle2=function(t,i,s,e,n){var h=p.Dot(e,n);n.scaleToRef(h,this.tv1),s.addToRef(this.tv1,this.tv2);var a=this.tv2;this.mainCamera.getWorldMatrix().invertToRef(this.tm),p.TransformCoordinatesToRef(this.tv2,this.tm,this.tv2);var o=0;a.x>=0&&a.y>=0?o=1:a.x<=0&&a.y>=0?o=2:a.x<=0&&a.y<=0?o=3:a.x>=0&&a.y<=0&&(o=4),p.TransformCoordinatesToRef(t,this.tm,this.tv1),p.TransformCoordinatesToRef(i,this.tm,this.tv2),this.tv2.subtractInPlace(this.tv1);var r=this.tv2,l=r.length(),c="";r.x>=0&&r.y>=0?c=r.x>=r.y?"r":"u":r.x<=0&&r.y>=0?c=-r.x>=r.y?"l":"u":r.x<=0&&r.y<=0?c=-r.x>=-r.y?"l":"d":r.x>=0&&r.y<=0&&(c=r.x>=-r.y?"r":"d");var d=0;return"d"==c?d=1==o||4==o?1:-1:"u"==c?d=1==o||4==o?-1:1:"r"==c?d=2==o||1==o?1:-1:"l"==c&&(d=2==o||1==o?-1:1),d*l},t.prototype.getAngle=function(t,i,s,e){t.subtractToRef(s,this.tv1),i.subtractToRef(s,this.tv2),p.CrossToRef(this.tv1,this.tv2,this.tv3);var n=Math.asin(this.tv3.length()/(this.tv1.length()*this.tv2.length()));return p.Dot(this.tv3,e)>0&&(n*=-1),n},t.prototype.createMaterials=function(i){this.redMat=t.getStandardMaterial("redMat",e.Red(),i),this.greenMat=t.getStandardMaterial("greenMat",e.Green(),i),this.blueMat=t.getStandardMaterial("blueMat",e.Blue(),i),this.whiteMat=t.getStandardMaterial("whiteMat",e.White(),i),this.yellowMat=t.getStandardMaterial("whiteMat",e.Yellow(),i)},t.prototype.disposeMaterials=function(){this.redMat.dispose(),this.greenMat.dispose(),this.blueMat.dispose(),this.whiteMat.dispose(),this.yellowMat.dispose()},t.getStandardMaterial=function(t,i,s){var n=new c(t,s);return n.emissiveColor=i,n.diffuseColor=e.Black(),n.specularColor=e.Black(),n.backFaceCulling=!1,n},t}();t.EditControl=d;var u=function(){function t(t,i){this.lastMax=10,this.acts=new Array,this.last=-1,this.current=-1,this.mesh=t,this.lastMax=i-1,this.add()}return t.prototype.setCapacity=function(t){if(0==t)return void console.error("capacity should be more than zero");this.lastMax=t-1,this.last=-1,this.current=-1,this.acts=new Array,this.add()},t.prototype.add=function(t){void 0===t&&(t=null);var i=new y(this.mesh,t);this.current<this.last&&(this.acts.splice(this.current+1),this.last=this.current),this.last==this.lastMax?(this.acts.shift(),this.acts.push(i)):(this.acts.push(i),this.last++,this.current++)},t.prototype.undo=function(){if(this.current>0){var t=this.acts[this.current].getActionType();return this.current--,this.acts[this.current].perform(this.mesh),t}},t.prototype.redo=function(){if(this.current<this.last)return this.current++,this.acts[this.current].perform(this.mesh),this.acts[this.current].getActionType()},t}();t.ActHist=u;var y=function(){function t(t,i){this.p=t.position.clone(),null==t.rotationQuaternion?(this.rQ=null,this.rE=t.rotation.clone()):(this.rQ=t.rotationQuaternion.clone(),this.rE=null),this.s=t.scaling.clone(),this.at=i}return t.prototype.getActionType=function(){return this.at},t.prototype.perform=function(t){t.position.copyFrom(this.p),null==t.rotationQuaternion?null!=this.rE?t.rotation.copyFrom(this.rE):t.rotation.copyFrom(this.rQ.toEulerAngles()):null!=this.rQ?t.rotationQuaternion.copyFrom(this.rQ):t.rotationQuaternion.copyFrom(r.RotationYawPitchRoll(this.rE.y,this.rE.x,this.rE.z)),t.scaling.copyFrom(this.s)},t}();t.Act=y}(t.component||(t.component={}))}(t.babylonjs||(t.babylonjs={}))}(t.ssatguru||(t.ssatguru={}))}(org||(org={}));